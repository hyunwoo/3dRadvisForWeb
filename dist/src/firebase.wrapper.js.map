{"version":3,"sources":["../../src/firebase.wrapper.js"],"names":["config","apiKey","authDomain","databaseURL","storageBucket","messagingSenderId","__Firebase","that","fb","firebase","initializeApp","auth","user","undefined","isSetReferences","EventName","ChildAdded","ChildRemoved","ChildChange","authChange","addAuthChangeFunction","evt","push","usageData","DBRefDimensionList","DBRefDataList","callbackEvents","callbackDimensions","DataList","CurrentData","CurrentDataKey","CurrentSetting","DimensionFieldList","setUsageData","d","callback","console","log","database","ref","uid","_id","rawDataReceiver","once","DataSet","val","settingDataReceiver","then","snapshot","_","isNil","forEach","v","event","on","getUsageDataSetting","a","addDimensionField","field","key","data","update","deleteDimensionField","releaseUsageData","off","storage","testDataUrl","providerGoogle","GoogleAuthProvider","onAuthStateChanged","setTimeout","$","html","displayName","initDBReferences","onDimension","unbind","error","remove","clearDBReferences","getDataList","signInWithGoogle","signInWithPopup","result","token","credential","accessToken","catch","errorCode","code","errorMessage","message","email","signInWithEmail","signOut","__UIStatic","Toast","open","window","location","getRawData","getDataContent","deleteData","set","uploadData","f","refList","refRaw","dSet","contents","JSON","stringify","length","post","body","updates","dataInfo","name","size","type","lastModified","overview","fail","always"],"mappings":"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","file":"firebase.wrapper.js","sourcesContent":["/**\r\n * Created by hyunwoo on 2017-02-16.\r\n */\r\nvar config = {\r\n    apiKey: \"AIzaSyBmWUxSYfDdIig4b_Nk_8zGW5VdDr1qY-M\",\r\n    authDomain: \"dradvis.firebaseapp.com\",\r\n    databaseURL: \"https://dradvis.firebaseio.com\",\r\n    storageBucket: \"dradvis.appspot.com\",\r\n    messagingSenderId: \"20687471588\"\r\n};\r\n\r\nlet __Firebase = new function () {\r\n    const that = this;\r\n\r\n    let fb = firebase.initializeApp(config);\r\n    let auth = fb.auth();\r\n    this.user = undefined;\r\n    let isSetReferences = false;\r\n\r\n    this.EventName = {\r\n        ChildAdded: 'child_added',\r\n        ChildRemoved: 'child_removed',\r\n        ChildChange: 'child_changed'\r\n    };\r\n\r\n\r\n    this.authChange = [];\r\n    this.addAuthChangeFunction = function (evt) {\r\n        that.authChange.push(evt);\r\n    };\r\n\r\n    let usageData;\r\n    let DBRefDimensionList;\r\n\r\n    let DBRefDataList;\r\n    let callbackEvents = {};\r\n    let callbackDimensions = {};\r\n    let DataList = this.DataList = {};\r\n    this.CurrentData = {};\r\n    this.CurrentDataKey = '';\r\n    this.CurrentSetting = {};\r\n    this.DimensionFieldList = {};\r\n\r\n\r\n    this.setUsageData = async function (d, callback) {\r\n        usageData = d;\r\n        console.log(\" Data & Dimension Event Injected\");\r\n        DBRefDimensionList = fb.database().ref(that.user.uid + '/list/' + d._id + '/dimension');\r\n\r\n        var rawDataReceiver = await fb.database().ref(that.user.uid + '/raw/' + d._id).once('value');\r\n        that.CurrentData = new DataSet(rawDataReceiver.val());\r\n        that.CurrentDataKey = d._id;\r\n        var settingDataReceiver = await fb.database().ref(that.user.uid + '/setting/' + d._id).once('value');\r\n        that.CurrentSetting = settingDataReceiver.val();\r\n        callback(rawDataReceiver.val());\r\n        // fb.database().ref(that.user.uid + '/raw/' + d._id).once('value').then(function (snapshot) {\r\n        //     that.CurrentData = new DataSet(snapshot.val());\r\n        //     callback(snapshot.val());\r\n        // });\r\n\r\n        DBRefDimensionList.once('value').then(function (snapshot) {\r\n            if (_.isNil(snapshot.val())) return;\r\n            that.DimensionFieldList[snapshot.val()._id] = snapshot.val();\r\n            const val = snapshot.val();\r\n            _.forEach(callbackDimensions[that.EventName.ChildAdded], function (callback) {\r\n                _.forEach(val, function (v) {\r\n                    callback(v);\r\n                })\r\n            })\r\n        });\r\n\r\n        _.forEach(that.EventName, function (event) {\r\n            console.log('Alloc Dimension Event : ' + event);\r\n            DBRefDimensionList.on(event, function (snapshot) {\r\n                console.log(event, snapshot.val());\r\n                switch (event) {\r\n                    case that.EventName.ChildAdded:\r\n                    case that.EventName.ChildChange:\r\n                        that.DimensionFieldList[snapshot.val()._id] = snapshot.val();\r\n                        break;\r\n                    case that.EventName.ChildRemoved:\r\n                        delete that.DimensionFieldList[snapshot.val()._id];\r\n                        break;\r\n                }\r\n\r\n                _.forEach(callbackDimensions[event], function (callback) {\r\n                    callback(snapshot.val());\r\n                });\r\n            });\r\n        });\r\n    };\r\n\r\n    this.getUsageDataSetting = async function () {\r\n        console.log('asdfasdf');\r\n        var a = await fb.database().ref(that.user.uid + '/setting/' + usageData._id).once('value');\r\n        return a.val();\r\n\r\n\r\n    };\r\n\r\n    /**\r\n     * @param field : object\r\n     *      @name : string\r\n     *      @dimensionList : list //TODO will Change\r\n     */\r\n    this.addDimensionField = function (field) {\r\n        const key = DBRefDimensionList.push().key;\r\n        let data = {};\r\n        field['_id'] = key;\r\n        data[key] = field;\r\n        DBRefDimensionList.update(data);\r\n    };\r\n\r\n    this.deleteDimensionField = function (field) {\r\n        console.log('delete field : ', that.user.uid + '/list/' + field._id + '/dimension/' + field._id);\r\n        let data = {};\r\n        data[field._id] = null;\r\n        DBRefDimensionList.update(data);\r\n    };\r\n\r\n    this.releaseUsageData = function () {\r\n        usageData = null;\r\n        console.log(\"Data & Dimension Event Released\");\r\n        if (!_.isNil(DBRefDimensionList)) DBRefDimensionList.off();\r\n        callbackDimensions = {};\r\n        that.DimensionFieldList = {};\r\n    };\r\n    this.storage = firebase.storage();\r\n    this.testDataUrl = 'https://firebasestorage.googleapis.com/v0/b/dradvis.appspot.com/o/credos_testing.csv?alt=media&token=27152d59-bf4a-41cf-8658-1c3581c08c5e';\r\n    let providerGoogle = new firebase.auth.GoogleAuthProvider();\r\n    fb.auth().onAuthStateChanged(function (user) {\r\n        console.log('auth change input');\r\n        setTimeout(function () {\r\n            that.user = user;\r\n            if (user) {\r\n                console.log('auth changed', user);\r\n                $('.userName').html(user.displayName);\r\n                initDBReferences();\r\n                isSetReferences = true;\r\n            } else {\r\n            }\r\n            _.forEach(that.authChange, function (d) {\r\n                d(user);\r\n            });\r\n        }, 100);\r\n        // __UIStatic.onAuthChange(user);\r\n    });\r\n\r\n    function initDBReferences() {\r\n        if (isSetReferences) return;\r\n        isSetReferences = true;\r\n\r\n        DBRefDataList = fb.database().ref(that.user.uid + '/list');\r\n\r\n        _.forEach(that.EventName, function (evt) {\r\n            DBRefDataList.on(evt, function (snapshot) {\r\n                switch (evt) {\r\n                    case 'child_added' :\r\n                    case 'child_changed' :\r\n                        DataList[snapshot.val()._id] = snapshot.val();\r\n                        break;\r\n                    case 'child_removed':\r\n                        delete DataList[snapshot.val()._id];\r\n                        break;\r\n                }\r\n                _.forEach(callbackEvents[evt], function (callback) {\r\n                    callback(snapshot.val());\r\n                });\r\n            });\r\n        });\r\n    }\r\n\r\n    this.on = function (evt, callback) {\r\n        if (_.isNil(callbackEvents[evt])) callbackEvents[evt] = [];\r\n        callbackEvents[evt].push(callback);\r\n        return callback;\r\n    };\r\n\r\n    this.onDimension = function (evt, callback) {\r\n        if (_.isNil(callbackDimensions[evt])) callbackDimensions[evt] = [];\r\n        callbackDimensions[evt].push(callback);\r\n        return callback;\r\n    };\r\n\r\n    this.unbind = function (evt, callback) {\r\n        if (_.isNil(callbackEvents[evt])) {\r\n            console.error('event not binded');\r\n            return;\r\n        }\r\n        if (_.isNil(callback)) callbackEvents[evt] = [];\r\n        else if (!_.isNil(callback)) callbackEvents[evt] = _.remove(callbackEvents[evt], callback);\r\n    };\r\n\r\n\r\n    function clearDBReferences() {\r\n\r\n    }\r\n\r\n    this.getDataList = function () {\r\n\r\n    };\r\n\r\n    this.signInWithGoogle = function () {\r\n        fb.auth().signInWithPopup(providerGoogle).then(function (result) {\r\n            var token = result.credential.accessToken;\r\n            var user = result.user;\r\n            // ...\r\n        }).catch(function (error) {\r\n            console.log(error);\r\n            // Handle Errors here.\r\n            var errorCode = error.code;\r\n            var errorMessage = error.message;\r\n            // The email of the user's account used.\r\n            var email = error.email;\r\n            // The firebase.auth.AuthCredential type that was used.\r\n            var credential = error.credential;\r\n            // ...\r\n        });\r\n    };\r\n\r\n    this.signInWithEmail = function () {\r\n\r\n    };\r\n\r\n    this.signOut = function () {\r\n        if (_.isNil(that.user)) {\r\n            __UIStatic.Toast.open(\"Auth Failed\");\r\n            return;\r\n        }\r\n\r\n        auth.signOut().then(function () {\r\n            that.user = undefined;\r\n            window.location = '/';\r\n        }, function (error) {\r\n            __UIStatic.Toast.open(\"SignOut Failed\");\r\n        });\r\n\r\n    };\r\n\r\n    this.getDataList = function () {\r\n        if (_.isNil(that.user)) {\r\n            __UIStatic.Toast.open(\"Auth Failed\");\r\n            return;\r\n        }\r\n    };\r\n\r\n\r\n    this.getRawData = async function (key, callback) {\r\n        console.log('ref', that.user.uid + '/raw/' + key);\r\n        let a = await fb.database().ref(that.user.uid + '/raw/' + key).once('value');\r\n        return a.val();\r\n    };\r\n\r\n    this.getDataContent = function (key) {\r\n        if (_.isNil(that.user)) {\r\n            __UIStatic.Toast.open(\"Auth Failed\");\r\n            return;\r\n        }\r\n    };\r\n\r\n    this.deleteData = function (d) {\r\n        console.log('deleteData:', d);\r\n        var ref = fb.database().ref(that.user.uid + '/list/' + d._id);\r\n        ref.set(null);\r\n    };\r\n\r\n\r\n    this.uploadData = function (f) {\r\n        console.log('uploadFile!?');\r\n\r\n        if (_.isNil(that.user)) {\r\n            __UIStatic.Toast.open(\"Auth Failed\");\r\n            return null;\r\n        }\r\n\r\n        const refList = fb.database().ref(that.user.uid + '/list');\r\n        const refRaw = fb.database().ref(that.user.uid + '/raw');\r\n        const key = refList.push().key;\r\n\r\n        // TODO Convert Worker\r\n        // var worker = new Worker('/radvis.data.js');\r\n        // worker.postMessage('hello!!');\r\n        // worker.addEventListener('message', (d) => {\r\n        //     console.log('receive', d);\r\n        // });\r\n\r\n        // __UIStatic.Loader.open();\r\n        const dSet = new DataSet(f.contents);\r\n        console.log('dset length : ', JSON.stringify(dSet).length);\r\n        $.post('/api/correlation', dSet, function (body) {\r\n            let updates = {};\r\n            const dataInfo = {\r\n                name: f.name,\r\n                size: f.size,\r\n                type: f.type,\r\n                lastModified: f.lastModified,\r\n                _id: key,\r\n                overview: 'Not Yet Set Overview',\r\n            };\r\n\r\n            updates[that.user.uid + '/list/' + key] = dataInfo;\r\n            updates[that.user.uid + '/raw/' + key] = f.contents;\r\n            updates[that.user.uid + '/setting/' + key] = body;\r\n            updates[that.user.uid + '/dataset/' + key] = dSet;\r\n            fb.database().ref().update(updates);\r\n        }).fail(() => {\r\n            console.error('error');\r\n        }).always(() => {\r\n        });\r\n\r\n    };\r\n\r\n};\r\n\r\n$(function () {\r\n    //__Firebase.getDataList()\r\n});\r\n\r\n\r\n\r\n\r\n"]}